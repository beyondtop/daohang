"use strict";var Fxq={colors:["red","blue","#000"],fonts:["SimSun","YouYuan","KaiTi"],baseConf:{color:null,font:null},commonMethod:function(t,e){var a=null;void 0!==(a=this.colors[t])&&"undefined"!==a||(a=this.colors[0]);var n=this.fonts[e];void 0!==n&&"undefined"!==n||(n=this.fonts[0]),this.baseConf.color=a,this.baseConf.font=n},companySeal:function(t,e,a,n,o){var l=document.createElement("canvas"),i=l.getContext("2d");l.width=300,l.height=300,this.commonMethod(e,a);var r=l.width/2,s=l.height/2;return function(){i.translate(0,0),i.lineWidth=5,i.strokeStyle=Fxq.baseConf.color,i.beginPath(),i.arc(r,s,110,0,2*Math.PI),i.stroke(),i.save();l.toDataURL("image/jpeg")}(),function(){i.save(),i.fillStyle=Fxq.baseConf.color,i.translate(r,s),i.rotate(Math.PI),i.beginPath();for(var t=Math.PI/5*4,e=0;e<5;e++){var a=Math.sin(e*t),n=Math.cos(e*t);i.lineTo(30*a,30*n)}i.closePath(),i.stroke(),i.fill(),i.restore()}(),function(t){i.font="20px "+Fxq.baseConf.font,i.textBaseline="middle",i.textAlign="center",i.lineWidth=1,i.fillStyle=Fxq.baseConf.color,i.fillText(t,r,s+65)}(n),function(t){t||(t="          ");i.translate(r,s),i.font="bolder 8px "+Fxq.baseConf.font;for(var e=t.length,a=-2*Math.PI/(6*(e-1)),n=t.split(""),o=0;o<e;o++){var l=n[o];0===o?i.rotate(10*Math.PI/5.95):i.rotate(a),i.save(),i.translate(-95,5),i.rotate(Math.PI/2),i.fillStyle=Fxq.baseConf.color,i.fillText(l,0,5),i.restore()}}(o),function(){i.font="30px "+Fxq.baseConf.font;for(var e,a=t.length,n=-4*Math.PI/(3*(a-1)),o=t.split("").reverse(),l=0;l<a;l++)e=o[l],0==l?i.rotate(5*Math.PI/6.1):i.rotate(n),i.save(),i.translate(95,0),i.rotate(Math.PI/2),i.fillText(e,0,5),i.restore()}(),l.toDataURL()},personal:function(t,e,a,n,o=0){this.commonMethod(e,a);var l=Fxq.baseConf.color,i=Fxq.baseConf.font,r=document.createElement("canvas"),s=r.getContext("2d");r.width=120,r.height=120;var h=t.length;if(0===n)0===o&&(s.rect(5,5,100,50),s.strokeStyle=l,s.lineWidth=4,s.stroke()),s.font="30px "+i,h>3&&(s.font="24px "+i),s.textBaseline="middle",s.textAlign="center",s.lineWidth=1,s.fillStyle=l,s.textAlign="center",s.fillText(t,55,30);else{var f="";switch(t.length){case 3:t+="印";break;case 2:t+="之印"}if(t.length>1){var c=t.split("");f=c[2]+c[0]+c[3]+c[1]}else f=t+"    ";0===o&&(s.rect(2,2,108,108),s.strokeStyle=l,s.lineWidth=2,s.stroke()),s.font="40px "+i,s.fillStyle=l,this.wrapText(s,f,8,45,80,40)}return r.toDataURL()},companyEllipse:function(t,e,a,n,o){var l=140,i=90;this.commonMethod(e,a);var r=Fxq.baseConf.color,s=Fxq.baseConf.font,h=document.createElement("canvas");h.width=300,h.height=300,h.width=285,h.height=185;var f=h.getContext("2d");function c(t,e){var a=180;s="20px "+s,t||(a=60,s="10px "+s);var n=e.length,o=l+f.lineWidth,h=i+f.lineWidth,c=!0===t?-90-a/2:90-a/2,d=Math.ceil(a/.5)+1,x=new Array(d),v=new Array(d),M=0,u=0;x[M]=c,v[M]=u,M++;for(var g=c*Math.PI/180,p=l*Math.cos(g)+o,m=i*Math.sin(g)+h,b=c+.5;M<d;b+=.5){g=b*Math.PI/180;var y=l*Math.cos(g)+o,P=i*Math.sin(g)+h;u+=Math.sqrt((p-y)*(p-y)+(m-P)*(m-P)),x[M]=b,v[M]=u,p=y,m=P,M++}var I=u/n;for(b=0;b<n;b++){for(var C=b*I+I/2,S=0,w=0;w<v.length-1;w++)if(v[w]<=C&&C<=v[w+1]){S=C>=(v[w]+v[w+1])/2?x[w+1]:x[w];break}g=S*Math.PI/180;y=l*Math.cos(g)+l,P=i*Math.sin(g)+i;var T=Math.atan2(i*Math.cos(g),-140*Math.sin(g)),q=T+Math.PI/2,F=e[!0===t?b:n-1-b],k=25,W=31;t||(k=2,W=10),y+=.9*W*Math.cos(q),P+=.9*W*Math.sin(q),t?(y+=-k/2*Math.cos(T),P+=-k/2*Math.sin(T)):(y+=k/2*Math.cos(T),P+=k/2*Math.sin(T)),f.save(),f.translate(y,P),1==t?f.rotate((180*q/Math.PI-90)*Math.PI/180):f.rotate((180*q/Math.PI+180-90)*Math.PI/180),f.translate(-y,-P),f.fillStyle=r,f.font=s,f.fillText(F,y,P),f.restore()}}return c(!0,t),c(!1,o),function(t){f.fillStyle=r,f.font="20px SimSun",f.textAlign="center",f.fillText(t,l,110),f.restore()}(n),f.ellipse(l+f.lineWidth+1,i+f.lineWidth+1,l,i,0,0,2*Math.PI),f.fillStyle="rgba(255, 255, 255, 0)",f.strokeStyle=r,f.lineWidth=3,f.fill(),f.stroke(),h.toDataURL()},wrapText:function(t,e,a,n,o,l){if("string"==typeof e&&"number"==typeof a&&"number"==typeof n){var i=t,r=i.canvas;void 0===o&&(o=r&&r.width||112),void 0===l&&(l=r&&parseInt(window.getComputedStyle(r).lineHeight)||parseInt(window.getComputedStyle(document.body).lineHeight));for(var s=e.split(""),h="",f=0;f<s.length;f++){var c=h+s[f];i.measureText(c).width>o&&f>0?(i.fillText(s[0],a,n),i.fillText(s[1],a+50,n),h=s[f],n+=l):h=c}i.fillText(s[2],a,n+10),i.fillText(s[3],a+50,n+10)}}};
